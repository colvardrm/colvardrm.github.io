---
layout: post
title: Elm Commands, Subscriptions, and Ports
---

Commands in Elm are pretty appropriately named. Really, all you're doing with them is telling Elm (or whatever program you're talking to) to perform some function. It'll hand the result back to you when it's done, which you tag with a mesage type so that your update function can recognize it (in some cases, see my complaint below). Subscriptions are also named pretty well, though the name seems to imply that all subscriptions are recurring, when in fact they are simply commands from outside programs coming in and attempting to interact with your Elm program. When a subscription message comes in, you can tag the value with a message type like with a command so your update function can recognize it. Both of these are used in ports, which are described in the [Interop section of the elm architecture guide](http://guide.elm-lang.org/interop/), but I'll mention some of the particulars that the tutorial leaves out.

As a brief introduction, ports are ways to interact with programs outside of Elm. The tutorial describes them as holes in the side of your program for other programs to interact with, but I prefer thinking of them as passing shaped messages between the two processes you want to interact. The messages are shaped because they are sent by specific ports and intended for specific ports. To get some outside Javascript library to return the result of a function to you, just send a message to the Html page with the Javascript on it and a port that will recognize the type of message you sent, have the Javascript perform the function on receiving the message, and then send the new message with the result back to a receiving port in your Elm program. To embed your Elm program in an existing Html page, you should compile the program to a .js file with elm make --*output*.js. **An important note is that you must name your module in Elm for this to work**. This cost me about half an hour simply because the tutorial never mentioned it and I didn't think it was an issue. 

If there's one complaint that I have, it's that in a few cases (Random.generate comes to mind), slight ease of use has been chosen over consistency, which can make the indiviual command easy to explain, but the interaction between commands and subscriptions a bit more confusing and arbitrary. In the Random.generate function, you tag the message that will come back before you send the command message. From the pattern established by ports, you would expect to send a command for the generate function through an outgoing port and receive it via the subscription function with a receiving port, or some equivalent.
